{"version":3,"sources":["../module_lifecycle/on_bot_mount.ts"],"names":["getOnBotMount","state","bp","botId","ghost","forBot","emb","BotpressEmbedder","embedder","axiosConfig","http","getAxiosConfigForBot","predictor","BotpressPredictor","load"],"mappings":";;;;;;;AAGA;;AACA;;AAEO,SAASA,aAAT,CAAuBC,KAAvB,EAAyC;AAC9C,SAAO,OAAOC,EAAP,EAAuBC,KAAvB,KAAyC;AAC9CF,IAAAA,KAAK,CAACE,KAAD,CAAL,GAAe,EAAf;AACAF,IAAAA,KAAK,CAACE,KAAD,CAAL,CAAaC,KAAb,GAAqBF,EAAE,CAACE,KAAH,CAASC,MAAT,CAAgBF,KAAhB,CAArB;AAEA,UAAMG,GAAG,GAAG,IAAIC,0BAAJ,CAAqBJ,KAArB,EAA4BF,KAAK,CAACE,KAAD,CAAL,CAAaC,KAAzC,CAAZ,CAJ8C,CAK9C;;AACAH,IAAAA,KAAK,CAACE,KAAD,CAAL,CAAaK,QAAb,GAAwBF,GAAxB;AAEA,UAAMG,WAAW,GAAG,MAAMP,EAAE,CAACQ,IAAH,CAAQC,oBAAR,CAA6BR,KAA7B,CAA1B;AACAF,IAAAA,KAAK,CAACE,KAAD,CAAL,CAAaM,WAAb,GAA2BA,WAA3B;AAEA,UAAMG,SAAS,GAAG,IAAIC,qCAAJ,CAAsBJ,WAAtB,EAAmCN,KAAnC,CAAlB;AACAF,IAAAA,KAAK,CAACE,KAAD,CAAL,CAAaS,SAAb,GAAyBA,SAAzB;AAEA,UAAMX,KAAK,CAACE,KAAD,CAAL,CAAaK,QAAb,CAAsBM,IAAtB,CAA2BL,WAA3B,CAAN;AACD,GAfD;AAgBD","sourceRoot":"/mnt/Documents/Projets/BotPress/botpress/modules/visualisation/src/backend","sourcesContent":["import * as sdk from 'botpress/sdk'\n\nimport { BotState, VisuState } from '../backend/typings'\nimport { BotpressPredictor } from '../models/botpress_predictor'\nimport { BotpressEmbedder, PythonEmbedder } from '../models/embedder'\n\nexport function getOnBotMount(state: VisuState) {\n  return async (bp: typeof sdk, botId: string) => {\n    state[botId] = {} as BotState\n    state[botId].ghost = bp.ghost.forBot(botId)\n\n    const emb = new BotpressEmbedder(botId, state[botId].ghost)\n    // const emb = new PythonEmbedder(state.ghost)\n    state[botId].embedder = emb\n\n    const axiosConfig = await bp.http.getAxiosConfigForBot(botId)\n    state[botId].axiosConfig = axiosConfig\n\n    const predictor = new BotpressPredictor(axiosConfig, botId)\n    state[botId].predictor = predictor\n\n    await state[botId].embedder.load(axiosConfig)\n  }\n}\n"]}